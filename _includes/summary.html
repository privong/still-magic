{% comment %}
Summarize all header points of one kind from all lessons. Parameters are:

- language: a two-letter language code like "en".
- h: level of heading, e.g. "h2".
{% endcomment %}

{% comment %}
Choose a block of chapters from "_config.yml" based on the language.
{% endcomment %}
{% if include.language == 'en' %}
  {% assign chapters = site.en %}
{% elsif include.language == 'um' %}
  {% assign chapters = site.um %}
{% endif %}
{% assign translations=site.translations[include.language] %}

{% comment %} Figure out the path to the root of the collection. {% endcomment %}
{% if page.root %}{% assign rootpath = "." %}{% else %}{% assign rootpath = ".." %}{% endif %}

{% comment %}
Loop over the table of contents to find this chapter (because Jekyll does not
support lookup by key) and pull the required block out of that lesson's header.
{% endcomment %}
{%- for lesson in site.toc.lessons -%}
  {%- for chap in chapters -%}
    {%- if lesson == chap.slug -%}
      {%- if include.which == 'questions' -%}
        {%- assign which = chap.questions -%}
      {%- elsif include.which == 'objectives' -%}
        {%- assign which = chap.objectives -%}
      {%- elsif include.which == 'keypoints' -%}
        {%- assign which = chap.keypoints -%}
      {%- endif -%}
      {%- if which -%}
<{{include.h}}><a href="{{rootpath}}/{{chap.slug}}/">{{chap.title}}</a></{{include.h}}>
<div markdown="1">
{% for item in which %}
- {{item}}{% endfor %}
</div>
      {%- endif -%}
      {%- break -%}
    {%- endif -%}
  {%- endfor -%}
{%- endfor -%}
